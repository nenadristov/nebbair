@model NebbAir.Models.Patnici

@{
    ViewData["Title"] = "Create";
}

<h3>Book a New Flight</h3>
<p>
    Here you can book a new flight <br />
    <em>The fields marked with <span style="color: red;"> * </span> ARE REQUIRED</em>
</p>


<hr />
<div class="row">
    <div class="col-md-8">
        <form asp-action="Create" onsubmit="Proverka()">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <h4>Passenger Information</h4>
            <div class="row">
                <div class="form-group col-sm-6">
                    <label asp-for="Ime" class="control-label">First Name<span style="color: red;"> * </span></label>
                    <input asp-for="Ime" class="form-control" />
                    <span asp-validation-for="Ime" class="text-danger"></span>
                </div>
                <div class="form-group col-sm-6">
                    <label asp-for="DataNaRagjanje" class="control-label">Birth Date<span style="color: red;"> * </span></label>
                    <input asp-for="DataNaRagjanje" class="form-control" />
                    <span asp-validation-for="DataNaRagjanje" class="text-danger"></span>
                </div>
            </div>

            <div class="row">
                <div class="form-group col-sm-6">
                    <label asp-for="Prezime" class="control-label">Last Name<span style="color: red;"> * </span></label>
                    <input asp-for="Prezime" class="form-control" />
                    <span asp-validation-for="Prezime" class="text-danger"></span>
                </div>

                <div class="form-group col-sm-6">
                    <label asp-for="PassporNo" class="control-label">Passport Number<span style="color: red;"> * </span></label>
                    <input asp-for="PassporNo" class="form-control" />
                    <span asp-validation-for="PassporNo" class="text-danger"></span>
                </div>
            </div>
            <hr />

            <h4>Flight Information</h4>
            <div class="row">
                <div class="col-sm-6">

                </div>
                <div class="form-group col-sm-6">
                    <label asp-for="FlightNo" class="control-label">Flight Number<span style="color: red;"> * </span></label>
                    <input asp-for="FlightNo" class="form-control" />
                    <span asp-validation-for="FlightNo" class="text-danger"></span>
                </div>
            </div>

            <div class="row">

                <div class="form-group col-sm-6">
                    <label asp-for="Origin" class="control-label">Origin<span style="color: red;"> * </span></label>
                    <input asp-for="Origin" class="form-control" />
                    <span asp-validation-for="Origin" class="text-danger"></span>
                </div>
                <div class="form-group col-sm-6">
                    <label asp-for="Destination" class="control-label">Destination<span style="color: red;"> * </span></label>
                    <input asp-for="Destination" class="form-control" />
                    <span asp-validation-for="Destination" class="text-danger"></span>
                </div>
            </div>

            <div class="row">
                <div class="form-group col-sm-6">
                    <label asp-for="Departure" class="control-label">Departure<span style="color: red;"> * </span></label>
                    <input asp-for="Departure" class="form-control" />
                    <span asp-validation-for="Departure" class="text-danger"></span>
                </div>
                <div class="form-group col-sm-6">
                    <label asp-for="Return" class="control-label">Return</label>
                    <input asp-for="Return" class="form-control" />
                    <span asp-validation-for="Return" class="text-danger"></span>
                </div>
            </div>

            <div class="row">

                <div class="form-group col-sm-4">
                    <label asp-for="CarryOn" class="control-label">Carry On</label>
                    <input asp-for="CarryOn" class="form-control" />
                    <span asp-validation-for="CarryOn" class="text-danger"></span>
                </div>
                <div class="form-group col-sm-4">
                    <label asp-for="Trolley" class="control-label">Trolley </label>
                    <input asp-for="Trolley" class="form-control" />
                    <span asp-validation-for="Trolley" class="text-danger"></span>
                </div>
                <div class="form-group col-sm-4">
                    <label asp-for="CheckIn" class="control-label">Check-In Bag</label>
                    <input asp-for="CheckIn" class="form-control" />
                    <span asp-validation-for="CheckIn" class="text-danger"></span>
                </div>
            </div>
            <div class="form-group">
                <p><em>Double check the information before you book your flight</em></p>
                <input type="submit" value="Book" class="btn btn-primary" />
            </div>
        </form>
    </div>
</div>



@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}

}

<script>
    //regex broj na pasos
    $(document).ready(function () {
        $("input#PassporNo").on("input", function () {
            var input = document.getElementById("PassporNo").value;
            var regex = new RegExp("^[A-Z0-9]+$")
            if (regex.test(input) && input.length === 8) {
                console.log("Rabote");
                $("input#PassporNo").css("border-color", "green")
            }
            else {
                console.log("asd");
                $("input#PassporNo").css("border-color", "red")
            }
            //console.log(regex.test(input));
        })
    })
    //regex broj na let
    $(document).ready(function () {
        $("input#FlightNo").on("input", function () {
            var input = document.getElementById("FlightNo").value;
            var regex = new RegExp("^[0-9]+$")
            if (regex.test(input) && input.length === 4) {
                console.log("Rabote");
                $("input#FlightNo").css("border-color", "green")
            }
            else {
                console.log("asd");
                $("input#FlightNo").css("border-color", "red")
            }
            //console.log(regex.test(input));
        })
    })
    //function on submit
    function Proverka() {
        var pasos = document.getElementById("PassoprNo").value;
        var pasosRegex = new RegExp("^[A-Z0-9]+$");
        var let = document.getElementById("FlightNo").value;
        var letRegex = new RegExp("^[0-9]+$");
        if (pasosRegex.test(pasos) && pasos.length === 7) {
            console.log("")
        }
        else {
            alert("Input correct passport number");
        }
        if (letRegex.test(let) && let.length === 4) {
            console.log("")
        }
        else {
            alert("Input correct flight number");
        }
    }
    //populate passenger information fields
    $(document).ready(function () {
        $("input#PassporNo").on("input", function () {
            var input = document.getElementById("PassporNo").value;
            var regex = new RegExp("^[A-Z0-9]+$")
            if (regex.test(input) && input.length === 8) {

                //$("input#PassporNo").on("input", function () {
                console.log("blabla")
                $.ajax({
                    //base address/controller/Action
                    url: '/Patnicis/getPasos/',
                    type: 'GET',
                    data: {
                        //Passing Input parameter
                        Pasos: $('input#PassporNo').val()
                    },
                    success: function (result) {
                        console.log("Rabote ajax");
                    },
                    error: function () {
                        console.log("Ne Rabote ajax")
                    }
                });
                return false;
            }
        });
    });

    //populate flight information
    //populate passenger information fields
    $(document).ready(function () {
        $("input#FlightNo").on("input", function () {
            var input = document.getElementById("FlightNo").value;
            var regex = new RegExp("^[0-9]+$")
            if (regex.test(input) && input.length === 4) {

                //$("input#PassporNo").on("input", function () {
                console.log("blabla")
                $.ajax({
                    //base address/controller/Action
                    url: '/Patnicis/getFlight/',
                    type: 'GET',
                    data: {
                        //Passing Input parameter
                        Pasos: $('input#FlightNo').val()
                    },
                    success: function (result) {
                        console.log("Rabote ajax");
                    },
                    error: function () {
                        console.log("Ne Rabote ajax")
                    }
                });
                return false;
            }
        });
    });
</script>